<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>LYNX Intelligence | Institutional Dispatch</title>
    <script src="https://unpkg.com/lucide@latest"></script>
    <link href="https://fonts.googleapis.com/css2?family=Playfair+Display:wght@700&family=Inter:wght@400;600;800&display=swap" rel="stylesheet">
    
    <!-- Firebase SDK -->
    <script src="https://www.gstatic.com/firebasejs/10.7.1/firebase-app-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/10.7.1/firebase-auth-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/10.7.1/firebase-firestore-compat.js"></script>
    
    <style>
        :root {
            --paper-white: #ffffff;
            --ink-black: #121212;
            --accent-gold: #b38b4d;
            --news-gray: #f4f4f4;
            --border-soft: #d1d1d1;
            --bullish: #1a7d1a;
            --bearish: #b21203;
            --toast-bg: #1a1a1a;
        }

        * { margin: 0; padding: 0; box-sizing: border-box; }
        body { background-color: var(--paper-white); color: var(--ink-black); font-family: 'Inter', sans-serif; overflow-x: hidden; }

        /* TOAST NOTIFICATIONS */
        #toast-container { position: fixed; top: 20px; right: 20px; z-index: 2000; display: flex; flex-direction: column; gap: 10px; }
        .toast {
            background: var(--toast-bg); color: white; padding: 15px 25px; 
            border-left: 5px solid var(--accent-gold); box-shadow: 0 5px 15px rgba(0,0,0,0.2);
            font-size: 12px; font-weight: 600; text-transform: uppercase; letter-spacing: 1px;
            opacity: 0; transform: translateX(50px); animation: slideIn 0.3s forwards;
            display: flex; align-items: center; justify-content: space-between; min-width: 250px;
        }
        @keyframes slideIn { to { opacity: 1; transform: translateX(0); } }
        @keyframes fadeOut { to { opacity: 0; transform: translateX(50px); } }

        /* NAVIGATION & HEADER */
        .nav-bar { display: flex; justify-content: center; gap: 30px; padding: 15px; border-bottom: 1px solid var(--border-soft); background: #fff; position: sticky; top: 0; z-index: 100; flex-wrap: wrap; }
        .nav-link { text-decoration: none; color: var(--ink-black); font-size: 11px; font-weight: 800; text-transform: uppercase; letter-spacing: 1px; cursor: pointer; transition: 0.2s; position: relative; }
        .nav-link:hover, .nav-link.active { color: var(--accent-gold); }

        .market-ticker { background: var(--ink-black); color: white; height: 35px; display: flex; align-items: center; font-size: 11px; overflow: hidden; }
        .ticker-track { display: flex; white-space: nowrap; animation: ticker-move 40s linear infinite; }
        @keyframes ticker-move { 0% { transform: translateX(0); } 100% { transform: translateX(-50%); } }
        .ticker-item { margin-right: 40px; font-weight: 600; }

        @keyframes rotate { from { transform: rotate(0deg); } to { transform: rotate(360deg); } }
        .rotating { animation: rotate 1s linear infinite; }

        header { padding: 40px 5%; text-align: center; border-bottom: 4px double var(--border-soft); }
        .brand { font-family: 'Playfair Display', serif; font-size: 56px; color: var(--ink-black); text-decoration: none; cursor: pointer; }
        
        /* CONTENT LAYOUT */
        .container { max-width: 1440px; margin: 0 auto; padding: 30px; display: grid; grid-template-columns: 300px 1fr 320px; gap: 40px; }
        .page-content { display: none; }
        .page-content.active { display: grid; }

        .section-label { font-size: 12px; font-weight: 900; text-transform: uppercase; border-bottom: 2px solid var(--ink-black); margin-bottom: 15px; display: block; padding-bottom: 5px; }

        /* FULL WIDTH PAGES */
        .full-page { max-width: 1000px; margin: 0 auto; padding: 60px 20px; text-align: center; display: none; }
        .full-page.active { display: block; }

        /* DONATION CARDS */
        .donation-grid { display: grid; grid-template-columns: repeat(2, 1fr); gap: 30px; margin-top: 40px; max-width: 800px; margin-left: auto; margin-right: auto; }
        .donation-card { padding: 40px; border: 2px solid var(--border-soft); background: var(--news-gray); transition: 0.3s; cursor: pointer; text-align: left; }
        .donation-card:hover { border-color: var(--accent-gold); transform: translateY(-5px); box-shadow: 0 10px 30px rgba(0,0,0,0.1); }
        .donation-card.featured { background: var(--ink-black); color: white; border-color: var(--accent-gold); }

        /* CRYPTO PAGES */
        .crypto-header { display: flex; justify-content: space-between; align-items: flex-end; border-bottom: 1px solid #ddd; padding-bottom: 20px; margin-bottom: 30px; }
        .stat-grid { display: grid; grid-template-columns: repeat(4, 1fr); gap: 20px; margin-bottom: 40px; }
        .stat-card { background: var(--news-gray); padding: 20px; border: 1px solid #eee; text-align: left; }
        .stat-value { font-size: 24px; font-weight: 800; margin-top: 5px; }

        /* WIDGETS */
        .card { background: var(--news-gray); padding: 20px; margin-bottom: 25px; border-radius: 2px; border: 1px solid #eee; }

        .timeframe-btn { padding: 4px 8px; font-size: 10px; border: 1px solid var(--border-soft); background: white; cursor: pointer; margin-right: 4px; }
        .timeframe-btn.active { background: var(--ink-black); color: white; }

        .auth-btn { width: 100%; padding: 12px; background: var(--ink-black); color: white; border: none; cursor: pointer; font-weight: bold; text-transform: uppercase; letter-spacing: 1px; font-size: 11px; transition: 0.2s; }
        .auth-btn:hover { background: var(--accent-gold); }

        /* MODALS */
        .modal { display: none; position: fixed; z-index: 1000; left: 0; top: 0; width: 100%; height: 100%; background-color: rgba(0,0,0,0.7); overflow-y: auto; }
        .modal-content { background-color: white; margin: 5% auto; padding: 40px; width: 90%; max-width: 500px; border: 2px solid var(--accent-gold); }
        .close { color: #aaa; float: right; font-size: 28px; font-weight: bold; cursor: pointer; }
        .close:hover { color: #000; }
        .auth-input { width: 100%; padding: 12px; margin: 10px 0; border: 1px solid var(--border-soft); font-size: 13px; }
        .auth-tabs { display: flex; gap: 10px; margin-bottom: 20px; }
        .auth-tab { flex: 1; padding: 10px; background: var(--news-gray); cursor: pointer; text-align: center; font-weight: bold; font-size: 11px; border: 1px solid var(--border-soft); }
        .auth-tab.active { background: var(--ink-black); color: white; }

        /* LOGOUT CONFIRMATION MODAL */
        .confirm-modal { display: none; position: fixed; z-index: 2000; left: 0; top: 0; width: 100%; height: 100%; background-color: rgba(0,0,0,0.7); }
        .confirm-content { background-color: white; margin: 15% auto; padding: 40px; width: 90%; max-width: 400px; border: 2px solid var(--accent-gold); text-align: center; }
        .confirm-buttons { display: flex; gap: 10px; margin-top: 30px; }
        .confirm-btn { flex: 1; padding: 12px; border: none; cursor: pointer; font-weight: bold; text-transform: uppercase; font-size: 11px; letter-spacing: 1px; transition: 0.2s; }
        .confirm-yes { background: var(--bearish); color: white; }
        .confirm-yes:hover { background: #8b0000; }
        .confirm-no { background: var(--ink-black); color: white; }
        .confirm-no:hover { background: var(--accent-gold); }

        /* SENTIMENT GRID */
        .sentiment-grid { display: grid; grid-template-columns: repeat(2, 1fr); gap: 40px; margin-top: 40px; }

        /* TECHNICAL OUTLOOK FIX */
        #tv-container { height: 400px; width: 100%; }

        /* FOOTER */
        footer { background: var(--ink-black); color: white; padding: 30px 20px; text-align: center; border-top: 4px double var(--accent-gold); margin-top: 60px; }
        .social-links { display: flex; justify-content: center; gap: 30px; margin-top: 20px; }
        .social-link { display: flex; flex-direction: column; align-items: center; gap: 8px; text-decoration: none; color: white; transition: 0.3s; }
        .social-link:hover { color: var(--accent-gold); transform: translateY(-3px); }
        .social-icon { width: 40px; height: 40px; border: 2px solid white; border-radius: 50%; display: flex; align-items: center; justify-content: center; transition: 0.3s; }
        .social-link:hover .social-icon { border-color: var(--accent-gold); background: var(--accent-gold); }

        @media (max-width: 1100px) { 
            .container { grid-template-columns: 1fr; } 
            .stat-grid, .sentiment-grid, .donation-grid { grid-template-columns: 1fr; }
            #tv-container { height: 300px; }
        }
    </style>
</head>
<body>

    <div id="toast-container"></div>

    <!-- AUTH MODAL -->
    <div id="auth-modal" class="modal">
        <div class="modal-content">
            <span class="close" onclick="closeAuthModal()">&times;</span>
            <h2 style="font-family: 'Playfair Display'; margin-bottom: 20px;">Access LYNX Intelligence</h2>
            
            <div class="auth-tabs">
                <div class="auth-tab active" onclick="switchAuthTab('login')">LOGIN</div>
                <div class="auth-tab" onclick="switchAuthTab('signup')">SIGN UP</div>
            </div>

            <div id="login-form">
                <input type="email" id="login-email" class="auth-input" placeholder="Email Address">
                <input type="password" id="login-password" class="auth-input" placeholder="Password">
                <button class="auth-btn" onclick="handleLogin()">LOGIN</button>
                <div id="login-error" style="color: var(--bearish); font-size: 11px; margin-top: 10px;"></div>
            </div>

            <div id="signup-form" style="display: none;">
                <input type="text" id="signup-name" class="auth-input" placeholder="Full Name">
                <input type="email" id="signup-email" class="auth-input" placeholder="Email Address">
                <input type="password" id="signup-password" class="auth-input" placeholder="Password (min 6 characters)">
                <input type="password" id="signup-confirm" class="auth-input" placeholder="Confirm Password">
                <button class="auth-btn" onclick="handleSignup()">CREATE ACCOUNT</button>
                <div id="signup-error" style="color: var(--bearish); font-size: 11px; margin-top: 10px;"></div>
            </div>
        </div>
    </div>

    <!-- LOGOUT CONFIRMATION MODAL -->
    <div id="logout-modal" class="confirm-modal">
        <div class="confirm-content">
            <h2 style="font-family: 'Playfair Display'; margin-bottom: 20px;">Terminate Session?</h2>
            <p style="color: #666; font-size: 13px; line-height: 1.6;">Are you sure you want to log out of LYNX Intelligence?</p>
            <div class="confirm-buttons">
                <button class="confirm-btn confirm-no" onclick="closeLogoutModal()">CANCEL</button>
                <button class="confirm-btn confirm-yes" onclick="confirmLogout()">LOGOUT</button>
            </div>
        </div>
    </div>

    <div class="market-ticker">
        <div class="ticker-track" id="ticker">Synchronizing Market Data...</div>
    </div>

    <header>
        <a class="brand" onclick="switchPage('home')">LYNX INTELLIGENCE</a>
        <div style="font-size: 11px; letter-spacing: 3px; margin-top: 10px; color: #555;" id="live-clock"></div>
    </header>

    <nav class="nav-bar">
        <div class="nav-link active" onclick="switchPage('home')">Home / Despatches</div>
        <div class="nav-link" onclick="switchPage('bitcoin')" id="nav-bitcoin">Bitcoin Analytics</div>
        <div class="nav-link" onclick="switchPage('sentiment')" id="nav-sentiment">Global Sentiment</div>
        <div class="nav-link" onclick="switchPage('donate')" id="nav-donate">Support Us</div>
        <div class="nav-link" id="user-display" onclick="handleAuthClick()" style="border-left: 1px solid #ddd; padding-left: 30px;">Login / Sign Up</div>
    </nav>

    <div id="home-page" class="container page-content active">
        <aside>
            <span class="section-label">Market Overview</span>
            <div class="card" id="market-overview">
                <div style="font-size: 11px; text-align: center; padding: 20px; color: #666;">
                    Loading market data...
                </div>
            </div>

            <span class="section-label">Market Sentiment</span>
            <div class="card">
                <h3 style="font-size: 14px; font-weight: 800; margin-bottom: 15px;">Fear & Greed Index</h3>
                <div style="font-size: 48px; font-weight: 800; color: var(--accent-gold);" id="fear-greed-val">--</div>
                <div style="text-transform: uppercase; font-weight: bold; letter-spacing: 2px; font-size: 11px; margin-top: 10px;" id="fear-greed-label">Loading...</div>
                <div style="margin-top: 15px; height: 8px; background: linear-gradient(90deg, #b21203, #ff9800, #ffc107, #8bc34a, #4caf50); width: 100%; border-radius: 4px;"></div>
            </div>
        </aside>

        <main>
            <span class="section-label">The Lead Despatch</span>
            <div id="hero-section"></div>
            <div id="news-grid" style="display:grid; grid-template-columns: 1fr 1fr; gap:20px;"></div>
        </main>

        <aside>
            <span class="section-label">Institutional Radar</span>
            <div class="card">
                <p style="font-size: 11px; margin-bottom: 10px; color: #666;">Enter a valid BTC Address to scan on-chain liquidity.</p>
                <input type="text" id="wallet-addr" placeholder="BTC Wallet Address" style="width:100%; padding:10px; margin-bottom:10px; font-size:11px; border:1px solid #ccc;">
                <button class="auth-btn" style="padding:10px;" onclick="scanWallet()">QUERY ON-CHAIN</button>
                <div id="wallet-results" style="font-size: 11px; margin-top:15px; line-height: 1.6;"></div>
            </div>

            <span class="section-label">Technical Outlook</span>
            <div class="card" style="padding:10px;">
                <div style="margin-bottom:10px;">
                    <button class="timeframe-btn active" onclick="changeInterval('1')">1m</button>
                    <button class="timeframe-btn" onclick="changeInterval('60')">1h</button>
                    <button class="timeframe-btn" onclick="changeInterval('240')">4h</button>
                    <button class="timeframe-btn" onclick="changeInterval('D')">1D</button>
                    <button class="timeframe-btn" onclick="changeInterval('M')">1M</button>
                </div>
                <div id="tv-container"></div>
            </div>
        </aside>
    </div>

    <div id="bitcoin-page" class="full-page">
        <div class="crypto-header">
            <h1 style="font-family: 'Playfair Display'; font-size: 48px;">Bitcoin (BTC)</h1>
            <span style="font-size: 12px; font-weight: 800; background: var(--bullish); color: white; padding: 5px 10px;">100% FREE ACCESS</span>
        </div>
        
        <div class="stat-grid">
            <div class="stat-card">
                <div class="section-label" style="border:none; margin:0;">Current Price</div>
                <div class="stat-value" id="btc-price">Loading...</div>
            </div>
            <div class="stat-card">
                <div class="section-label" style="border:none; margin:0;">24h Volume</div>
                <div class="stat-value" id="btc-vol">Loading...</div>
            </div>
            <div class="stat-card">
                <div class="section-label" style="border:none; margin:0;">Market Cap</div>
                <div class="stat-value" id="btc-cap">Loading...</div>
            </div>
            <div class="stat-card">
                <div class="section-label" style="border:none; margin:0;">Circulating Supply</div>
                <div class="stat-value" id="btc-supply">Loading...</div>
            </div>
        </div>

        <div style="height: 500px; border: 1px solid #ddd; background: white; margin-bottom: 30px;" id="tv-container-btc"></div>

        <!-- AI ANALYSIS SECTION -->
        <div class="card" style="text-align: left; padding: 30px; margin-top: 30px;">
            <h2 style="font-family: 'Playfair Display'; font-size: 28px; margin-bottom: 20px; display: flex; align-items: center; gap: 10px;">
                <i data-lucide="brain-circuit" size="28"></i> AI Market Analysis
                <span style="font-size: 12px; background: var(--bullish); color: white; padding: 4px 8px; border-radius: 3px; margin-left: auto;">FREE</span>
            </h2>
            <button class="auth-btn" onclick="generateAIAnalysis()" style="max-width: 300px; margin-bottom: 20px;" id="ai-btn">
                GENERATE AI ANALYSIS
            </button>
            <div id="ai-analysis" style="font-size: 13px; line-height: 1.8; color: #333;">
                Click the button above to generate real-time AI-powered Bitcoin market analysis using Google Gemini.
            </div>
        </div>

        <p style="margin-top: 20px; font-size: 12px; color: #666;">
            Data provided by CoinGecko API ‚Ä¢ AI Analysis powered by Google Gemini
        </p>
    </div>

    <div id="sentiment-page" class="full-page">
        <h1 style="font-family: 'Playfair Display'; font-size: 48px; margin-bottom: 10px;">Global Market Sentiment</h1>
        <p style="font-size: 14px; color: var(--bullish); font-weight: 600; margin-bottom: 40px;">
            <i data-lucide="unlock" size="16" style="display: inline; vertical-align: middle;"></i> 100% Free Access
        </p>
        
        <div class="sentiment-grid">
            <div class="card" style="padding: 40px;">
                <h3 style="font-family: 'Playfair Display'; font-size: 24px;">Fear & Greed Index</h3>
                <div style="font-size: 64px; font-weight: 800; margin: 20px 0; color: var(--accent-gold);" id="fear-greed-val-page">--</div>
                <div style="text-transform: uppercase; font-weight: bold; letter-spacing: 2px;" id="fear-greed-label-page">Loading...</div>
                <div style="margin-top: 20px; height: 10px; background: linear-gradient(90deg, red, yellow, green); width: 100%; border-radius: 5px;"></div>
                <p style="margin-top: 20px; font-size: 12px; color: #666; text-align: left;">
                    The Fear & Greed Index analyzes emotions and sentiments from different sources and crunches them into a simple number.
                </p>
            </div>

            <div class="card" style="padding: 40px;">
                <h3 style="font-family: 'Playfair Display'; font-size: 24px;">Bitcoin Dominance</h3>
                <div style="font-size: 64px; font-weight: 800; margin: 20px 0; color: var(--accent-gold);" id="btc-dominance">--</div>
                <div style="text-transform: uppercase; font-weight: bold; letter-spacing: 2px;">Market Share</div>
                <p style="margin-top: 20px; font-size: 12px; color: #666; text-align: left;">
                    Bitcoin's dominance represents its market cap as a percentage of the total cryptocurrency market cap.
                </p>
            </div>

            <div class="card" style="padding: 40px;">
                <h3 style="font-family: 'Playfair Display'; font-size: 24px;">Total Market Cap</h3>
                <div style="font-size: 32px; font-weight: 800; margin: 20px 0; color: var(--accent-gold);" id="total-market-cap">Loading...</div>
                <div style="text-transform: uppercase; font-weight: bold; letter-spacing: 2px; font-size: 11px;">All Cryptocurrencies</div>
                <div style="margin-top: 15px; font-size: 13px; color: #666;">
                    24h Change: <span id="market-cap-change" style="font-weight: bold;">--</span>
                </div>
            </div>

            <div class="card" style="padding: 40px;">
                <h3 style="font-family: 'Playfair Display'; font-size: 24px;">24h Trading Volume</h3>
                <div style="font-size: 32px; font-weight: 800; margin: 20px 0; color: var(--accent-gold);" id="total-volume">Loading...</div>
                <div style="text-transform: uppercase; font-weight: bold; letter-spacing: 2px; font-size: 11px;">Global Volume</div>
                <p style="margin-top: 20px; font-size: 12px; color: #666; text-align: left;">
                    Total trading volume across all cryptocurrency markets in the last 24 hours.
                </p>
            </div>

            <div class="card" style="padding: 40px;">
                <h3 style="font-family: 'Playfair Display'; font-size: 24px;">Active Cryptocurrencies</h3>
                <div style="font-size: 64px; font-weight: 800; margin: 20px 0; color: var(--accent-gold);" id="active-cryptos">--</div>
                <div style="text-transform: uppercase; font-weight: bold; letter-spacing: 2px; font-size: 11px;">Live Coins</div>
            </div>

            <div class="card" style="padding: 40px;">
                <h3 style="font-family: 'Playfair Display'; font-size: 24px;">Bitcoin Change (24h)</h3>
                <div style="font-size: 24px; font-weight: 800; margin: 20px 0;">BTC/USD</div>
                <div style="font-size: 48px; font-weight: 800;" id="btc-change-display">--</div>
                <div style="font-size: 13px; margin-top: 10px; color: #666;">
                    Price: <span id="btc-price-display" style="font-weight: bold;">--</span>
                </div>
            </div>
        </div>
    </div>

    <div id="donate-page" class="full-page">
        <h1 style="font-family: 'Playfair Display'; font-size: 48px;">Support LYNX Intelligence</h1>
        <p style="color: #666; margin-bottom: 20px; max-width: 700px; margin-left: auto; margin-right: auto; line-height: 1.8;">
            Your contributions help us maintain and expand this free platform. Every donation supports development, 
            data feeds, AI features, and helps keep LYNX Intelligence accessible to everyone.
        </p>
        <p style="color: var(--accent-gold); margin-bottom: 40px; max-width: 700px; margin-left: auto; margin-right: auto; font-weight: 600; font-size: 14px;">
            <i data-lucide="heart" size="16" style="display: inline; vertical-align: middle;"></i> 
            10% of all donations go to charity annually ‚Ä¢ 90% funds platform development
        </p>
        
        <div class="donation-grid">
            <div class="donation-card" onclick="window.open('https://gofund.me/2966f629a', '_blank')">
                <h2 style="font-family: 'Playfair Display'; font-size: 24px; margin-bottom: 15px;">One-Time Donation</h2>
                <p style="font-size: 14px; margin: 15px 0; color: #666; line-height: 1.8;">
                    Support us with a single contribution to help fund new features and improve the platform.
                </p>
                <ul style="list-style: none; font-size: 13px; line-height: 2.2; padding: 0; margin: 20px 0;">
                    <li style="display: flex; align-items: center; gap: 10px;">
                        <i data-lucide="check" size="16" style="color: var(--bullish);"></i> 
                        Help fund new features
                    </li>
                    <li style="display: flex; align-items: center; gap: 10px;">
                        <i data-lucide="check" size="16" style="color: var(--bullish);"></i> 
                        Expand data coverage
                    </li>
                    <li style="display: flex; align-items: center; gap: 10px;">
                        <i data-lucide="check" size="16" style="color: var(--bullish);"></i> 
                        Support infrastructure
                    </li>
                    <li style="display: flex; align-items: center; gap: 10px;">
                        <i data-lucide="star" size="16" style="color: var(--accent-gold);"></i> 
                        Discord recognition
                    </li>
                </ul>
                <button class="auth-btn" style="margin-top:20px;">DONATE NOW</button>
            </div>

            <div class="donation-card featured">
                <div style="position: absolute; top: 15px; right: 15px; background: var(--accent-gold); color: var(--ink-black); font-size: 10px; font-weight: bold; padding: 5px 10px; border-radius: 3px;">RECURRING</div>
                <h2 style="font-family: 'Playfair Display'; font-size: 24px; margin-bottom: 15px;">Monthly Support</h2>
                <p style="font-size: 14px; margin: 15px 0; line-height: 1.8;">
                    Ongoing monthly support that makes a lasting impact on platform development.
                </p>
                <ul style="list-style: none; font-size: 13px; line-height: 2.2; padding: 0; margin: 20px 0;">
                    <li style="display: flex; align-items: center; gap: 10px;">
                        <i data-lucide="check" size="16"></i> 
                        Sustain platform development
                    </li>
                    <li style="display: flex; align-items: center; gap: 10px;">
                        <i data-lucide="check" size="16"></i> 
                        Early access to new features
                    </li>
                    <li style="display: flex; align-items: center; gap: 10px;">
                        <i data-lucide="check" size="16"></i> 
                        Priority feature requests
                    </li>
                    <li style="display: flex; align-items: center; gap: 10px;">
                        <i data-lucide="star" size="16" style="color: var(--accent-gold);"></i> 
                        VIP Discord recognition
                    </li>
                </ul>
                <button class="auth-btn" style="background: var(--accent-gold); margin-top:20px; color: white;" onclick="window.open('https://gofund.me/2966f629a', '_blank')">DONATE MONTHLY</button>
            </div>
        </div>

        <div style="margin-top: 50px; padding: 30px; background: linear-gradient(135deg, #f5f7fa 0%, #c3cfe2 100%); max-width: 800px; margin-left: auto; margin-right: auto; border-left: 4px solid var(--accent-gold); border-radius: 4px;">
            <h3 style="font-family: 'Playfair Display'; font-size: 22px; margin-bottom: 15px; display: flex; align-items: center; gap: 10px;">
                <i data-lucide="megaphone" size="24" style="color: var(--accent-gold);"></i>
                Donor Recognition Program
            </h3>
            <p style="font-size: 14px; line-height: 1.8; color: #333;">
                <strong>When you donate, you'll get recognition on our official Discord!</strong>
                <br><br>
                Your name and an optional message (why you donated or what you want people to know) will be 
                posted in our <strong>#supporters</strong> channel to showcase your generosity and support for the community.
                <br><br>
                This is our way of saying thank you and letting everyone know how amazing you are! ‚ù§Ô∏è
            </p>
        </div>

        <div style="margin-top: 30px; padding: 30px; background: var(--news-gray); max-width: 800px; margin-left: auto; margin-right: auto; border-left: 4px solid var(--bullish);">
            <h3 style="font-family: 'Playfair Display'; font-size: 20px; margin-bottom: 15px; display: flex; align-items: center; gap: 10px;">
                <i data-lucide="heart-handshake" size="22" style="color: var(--bullish);"></i>
                Our Commitment to Charity
            </h3>
            <p style="font-size: 13px; line-height: 1.8; color: #555;">
                <strong style="color: var(--bullish);">10% of our annual profits go to charity.</strong>
                <br><br>
                We believe in giving back. Every year, we donate 10% of our total profits to charitable organizations 
                focused on financial education, technology access, and community development. Your donation doesn't just 
                improve this platform‚Äîit helps make a real difference in the world.
            </p>
        </div>

        <div style="margin-top: 30px; padding: 30px; background: var(--news-gray); max-width: 800px; margin-left: auto; margin-right: auto; border-left: 4px solid var(--accent-gold);">
            <h3 style="font-family: 'Playfair Display'; font-size: 20px; margin-bottom: 15px;">Where Your Donations Go</h3>
            <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 20px; font-size: 13px; line-height: 1.8; color: #555; margin-top: 20px;">
                <div>
                    <strong style="color: var(--accent-gold);">üöÄ Platform Development</strong>
                    <p>New features, better UI/UX, performance improvements</p>
                </div>
                <div>
                    <strong style="color: var(--accent-gold);">üìä Data Feeds</strong>
                    <p>Premium APIs, real-time data, more markets</p>
                </div>
                <div>
                    <strong style="color: var(--accent-gold);">ü§ñ AI Features</strong>
                    <p>Advanced analysis, better models, more insights</p>
                </div>
                <div>
                    <strong style="color: var(--accent-gold);">üíª Infrastructure</strong>
                    <p>Hosting, domains, security, uptime</p>
                </div>
            </div>
        </div>
    </div>

    <footer>
        <div style="font-family: 'Playfair Display'; font-size: 24px; margin-bottom: 10px;">LYNX INTELLIGENCE</div>
        <p style="font-size: 11px; letter-spacing: 2px; color: #999;">INSTITUTIONAL GRADE FINANCIAL DATA ‚Ä¢ 100% FREE</p>
        
        <div class="social-links">
            <a href="https://discord.gg/HKpbP5rhvd" target="_blank" class="social-link">
                <div class="social-icon">
                    <svg width="20" height="20" viewBox="0 0 24 24" fill="currentColor">
                        <path d="M20.317 4.37a19.791 19.791 0 0 0-4.885-1.515a.074.074 0 0 0-.079.037c-.21.375-.444.864-.608 1.25a18.27 18.27 0 0 0-5.487 0a12.64 12.64 0 0 0-.617-1.25a.077.077 0 0 0-.079-.037A19.736 19.736 0 0 0 3.677 4.37a.07.07 0 0 0-.032.027C.533 9.046-.32 13.58.099 18.057a.082.082 0 0 0 .031.057a19.9 19.9 0 0 0 5.993 3.03a.078.078 0 0 0 .084-.028a14.09 14.09 0 0 0 1.226-1.994a.076.076 0 0 0-.041-.106a13.107 13.107 0 0 1-1.872-.892a.077.077 0 0 1-.008-.128a10.2 10.2 0 0 0 .372-.292a.074.074 0 0 1 .077-.01c3.928 1.793 8.18 1.793 12.062 0a.074.074 0 0 1 .078.01c.12.098.246.198.373.292a.077.077 0 0 1-.006.127a12.299 12.299 0 0 1-1.873.892a.077.077 0 0 0-.041.107c.36.698.772 1.362 1.225 1.993a.076.076 0 0 0 .084.028a19.839 19.839 0 0 0 6.002-3.03a.077.077 0 0 0 .032-.054c.5-5.177-.838-9.674-3.549-13.66a.061.061 0 0 0-.031-.03zM8.02 15.33c-1.183 0-2.157-1.085-2.157-2.419c0-1.333.956-2.419 2.157-2.419c1.21 0 2.176 1.096 2.157 2.42c0 1.333-.956 2.418-2.157 2.418zm7.975 0c-1.183 0-2.157-1.085-2.157-2.419c0-1.333.955-2.419 2.157-2.419c1.21 0 2.176 1.096 2.157 2.42c0 1.333-.946 2.418-2.157 2.418z"/>
                    </svg>
                </div>
                <span style="font-size: 10px; font-weight: 600; letter-spacing: 1px;">DISCORD</span>
            </a>
            
            <a href="https://www.youtube.com/@OfficialLynxCrypto" target="_blank" class="social-link">
                <div class="social-icon">
                    <svg width="22" height="22" viewBox="0 0 24 24" fill="currentColor">
                        <path d="M23.498 6.186a3.016 3.016 0 0 0-2.122-2.136C19.505 3.545 12 3.545 12 3.545s-7.505 0-9.377.505A3.017 3.017 0 0 0 .502 6.186C0 8.07 0 12 0 12s0 3.93.502 5.814a3.016 3.016 0 0 0 2.122 2.136c1.871.505 9.376.505 9.376.505s7.505 0 9.377-.505a3.015 3.015 0 0 0 2.122-2.136C24 15.93 24 12 24 12s0-3.93-.502-5.814zM9.545 15.568V8.432L15.818 12l-6.273 3.568z"/>
                    </svg>
                </div>
                <span style="font-size: 10px; font-weight: 600; letter-spacing: 1px;">YOUTUBE</span>
            </a>
        </div>
        
        <p style="margin-top: 30px; font-size: 10px; color: #666;">¬© 2026 LYNX Intelligence. All Rights Reserved.</p>
    </footer>

    <script type="text/javascript" src="https://s3.tradingview.com/tv.js"></script>
    <script>
        lucide.createIcons();
        
        // ========== FIREBASE CONFIGURATION ==========
        const firebaseConfig = {
            apiKey: "AIzaSyCl5bHJoZaaX8N4TUPnbu-NrHDIvuBQHIU",
            authDomain: "lynx-intelligence.firebaseapp.com",
            projectId: "lynx-intelligence",
            storageBucket: "lynx-intelligence.firebasestorage.app",
            messagingSenderId: "114194446993386059797",
            appId: "1:114194446993386059797:web:e8b7c0c8c8c8c8c8c8c8c8"
        };

        // Initialize Firebase
        let firebaseInitialized = false;
        try {
            firebase.initializeApp(firebaseConfig);
            firebaseInitialized = true;
            console.log("‚úÖ Firebase initialized successfully");
        } catch (error) {
            console.log("‚ö†Ô∏è Firebase error:", error.message);
            firebaseInitialized = false;
        }

        const auth = firebaseInitialized ? firebase.auth() : null;
        const db = firebaseInitialized ? firebase.firestore() : null;
        
        // ========== STATE MANAGEMENT ==========
        let currentUser = null;

        // ========== AUTHENTICATION ==========
        function openAuthModal() {
            document.getElementById('auth-modal').style.display = 'block';
        }

        function closeAuthModal() {
            document.getElementById('auth-modal').style.display = 'none';
            document.getElementById('login-error').innerText = '';
            document.getElementById('signup-error').innerText = '';
        }

        function switchAuthTab(tab) {
            document.querySelectorAll('.auth-tab').forEach(t => t.classList.remove('active'));
            event.target.classList.add('active');
            
            if(tab === 'login') {
                document.getElementById('login-form').style.display = 'block';
                document.getElementById('signup-form').style.display = 'none';
            } else {
                document.getElementById('login-form').style.display = 'none';
                document.getElementById('signup-form').style.display = 'block';
            }
        }

        async function handleLogin() {
            const email = document.getElementById('login-email').value.trim();
            const password = document.getElementById('login-password').value;
            
            if(!email || !password) {
                document.getElementById('login-error').innerText = 'Please fill in all fields';
                return;
            }

            if (!firebaseInitialized) {
                document.getElementById('login-error').innerText = 'Authentication service unavailable';
                return;
            }

            try {
                const userCredential = await auth.signInWithEmailAndPassword(email, password);
                currentUser = userCredential.user;
                updateUserDisplay();
                closeAuthModal();
                showToast("Welcome back, Commander", "success");
            } catch (error) {
                document.getElementById('login-error').innerText = error.message;
            }
        }

        async function handleSignup() {
            const name = document.getElementById('signup-name').value.trim();
            const email = document.getElementById('signup-email').value.trim();
            const password = document.getElementById('signup-password').value;
            const confirm = document.getElementById('signup-confirm').value;
            
            if(!name || !email || !password || !confirm) {
                document.getElementById('signup-error').innerText = 'Please fill in all fields';
                return;
            }

            if(password !== confirm) {
                document.getElementById('signup-error').innerText = 'Passwords do not match';
                return;
            }

            if(password.length < 6) {
                document.getElementById('signup-error').innerText = 'Password must be at least 6 characters';
                return;
            }

            if (!firebaseInitialized) {
                document.getElementById('signup-error').innerText = 'Authentication service unavailable';
                return;
            }

            try {
                const userCredential = await auth.createUserWithEmailAndPassword(email, password);
                await userCredential.user.updateProfile({ displayName: name });
                
                // Create user document in Firestore
                if (db) {
                    await db.collection('users').doc(userCredential.user.uid).set({
                        name: name,
                        email: email,
                        createdAt: firebase.firestore.FieldValue.serverTimestamp()
                    });
                }
                
                currentUser = userCredential.user;
                updateUserDisplay();
                closeAuthModal();
                showToast("Account created successfully", "success");
            } catch (error) {
                document.getElementById('signup-error').innerText = error.message;
            }
        }

        function handleAuthClick() {
            if(currentUser) {
                openLogoutModal();
            } else {
                openAuthModal();
            }
        }

        function openLogoutModal() {
            document.getElementById('logout-modal').style.display = 'block';
        }

        function closeLogoutModal() {
            document.getElementById('logout-modal').style.display = 'none';
        }

        async function confirmLogout() {
            if (firebaseInitialized && auth) {
                await auth.signOut();
            }
            currentUser = null;
            document.getElementById('user-display').innerText = 'Login / Sign Up';
            closeLogoutModal();
            showToast("Session terminated", "success");
            switchPage('home');
        }
        
        function updateUserDisplay() {
            const display = document.getElementById('user-display');
            if (currentUser) {
                const username = currentUser.email.split('@')[0].substring(0, 8).toUpperCase();
                display.innerText = `ID: ${username}`;
            }
        }

        // ========== NOTIFICATION SYSTEM ==========
        function showToast(msg, type = 'info') {
            const container = document.getElementById('toast-container');
            const toast = document.createElement('div');
            toast.className = 'toast';
            toast.style.borderLeftColor = type === 'success' ? '#1a7d1a' : type === 'error' ? '#b21203' : '#b38b4d';
            toast.innerHTML = `<span>${msg}</span> <i data-lucide="shield-check" size="16"></i>`;
            container.appendChild(toast);
            lucide.createIcons();

            setTimeout(() => {
                toast.style.animation = 'fadeOut 0.5s forwards';
                setTimeout(() => toast.remove(), 500);
            }, 3000);
        }

        // ========== NAVIGATION ==========
        function switchPage(pageId) {
            document.querySelectorAll('.page-content, .full-page').forEach(el => {
                el.classList.remove('active');
                if(el.style.display) el.style.display = 'none';
            });
            
            document.querySelectorAll('.nav-link').forEach(el => el.classList.remove('active'));
            const navMap = {
                'home': document.querySelector('.nav-link'),
                'bitcoin': document.getElementById('nav-bitcoin'),
                'sentiment': document.getElementById('nav-sentiment'),
                'donate': document.getElementById('nav-donate')
            };
            if (navMap[pageId]) navMap[pageId].classList.add('active');

            if(pageId === 'home') {
                document.getElementById('home-page').classList.add('active');
                document.getElementById('home-page').style.display = 'grid';
                initChart('tv-container');
            } else if (pageId === 'bitcoin') {
                document.getElementById('bitcoin-page').classList.add('active');
                document.getElementById('bitcoin-page').style.display = 'block';
                initChart('tv-container-btc');
                fetchCoinDetails('bitcoin');
            } else if (pageId === 'sentiment') {
                document.getElementById('sentiment-page').classList.add('active');
                document.getElementById('sentiment-page').style.display = 'block';
                fetchGlobalSentiment();
            } else if (pageId === 'donate') {
                document.getElementById('donate-page').classList.add('active');
                document.getElementById('donate-page').style.display = 'block';
                lucide.createIcons();
            }
        }

        // ========== CHARTING ==========
        function initChart(containerId) {
            try {
                new TradingView.widget({
                    "width": "100%", 
                    "height": containerId === 'tv-container' ? 400 : "100%", 
                    "symbol": "BINANCE:BTCUSDT",
                    "interval": "D", 
                    "timezone": "Etc/UTC", 
                    "theme": "light",
                    "style": "1", 
                    "locale": "en", 
                    "toolbar_bg": "#f1f3f6", 
                    "enable_publishing": false,
                    "hide_top_toolbar": false, 
                    "save_image": false, 
                    "container_id": containerId
                });
            } catch (e) {
                console.error("Chart init error:", e);
            }
        }
        
        function changeInterval(interval) {
            new TradingView.widget({
                "width": "100%", "height": 400, "symbol": "BINANCE:BTCUSDT",
                "interval": interval, "timezone": "Etc/UTC", "theme": "light",
                "style": "1", "locale": "en", "container_id": "tv-container"
            });
            document.querySelectorAll('.timeframe-btn').forEach(b => b.classList.remove('active'));
            event.target.classList.add('active');
        }

        // ========== AI ANALYSIS WITH GEMINI ==========
        async function generateAIAnalysis() {
            const analysisDiv = document.getElementById('ai-analysis');
            const btn = document.getElementById('ai-btn');
            
            btn.disabled = true;
            analysisDiv.innerHTML = '<div style="text-align: center; padding: 20px;"><i data-lucide="loader" size="24" class="rotating"></i> Generating AI analysis...</div>';
            lucide.createIcons();

            try {
                // Fetch current Bitcoin data
                const btcRes = await fetch('https://api.coingecko.com/api/v3/coins/bitcoin');
                if (!btcRes.ok) throw new Error('Failed to fetch Bitcoin data');
                
                const btcData = await btcRes.json();
                const price = btcData.market_data.current_price.usd;
                const change24h = btcData.market_data.price_change_percentage_24h;
                const volume = btcData.market_data.total_volume.usd;
                const marketCap = btcData.market_data.market_cap.usd;
                const high24h = btcData.market_data.high_24h.usd;
                const low24h = btcData.market_data.low_24h.usd;

                // Call Gemini API
                const GEMINI_API_KEY = 'AIzaSyC0E6JMQQNq-Tv2iOOAW16QVOpEZ1nTxiQ';
                
                const response = await fetch(`https://generativelanguage.googleapis.com/v1beta/models/gemini-pro:generateContent?key=${GEMINI_API_KEY}`, {
                    method: "POST",
                    headers: { "Content-Type": "application/json" },
                    body: JSON.stringify({
                        contents: [{
                            parts: [{
                                text: `You are a professional cryptocurrency market analyst. Provide a concise, institutional-grade analysis of Bitcoin's current market conditions based on this data:

Current Price: $${price.toLocaleString()}
24h Change: ${change24h.toFixed(2)}%
24h High: $${high24h.toLocaleString()}
24h Low: $${low24h.toLocaleString()}
24h Volume: $${volume.toLocaleString()}
Market Cap: $${marketCap.toLocaleString()}

Provide analysis covering:
1. Current market sentiment (2 sentences)
2. Key technical levels and price action (2-3 sentences)
3. Short-term outlook and potential catalysts (2 sentences)

Keep the tone professional and data-driven. Format with clear paragraphs.`
                            }]
                        }]
                    })
                });

                if (!response.ok) {
                    const error = await response.json();
                    throw new Error(error.error?.message || 'API request failed');
                }

                const data = await response.json();
                
                if(data.candidates && data.candidates[0]?.content?.parts?.[0]?.text) {
                    const analysis = data.candidates[0].content.parts[0].text;
                    analysisDiv.innerHTML = `
                        <div style="background: #f9f9f9; padding: 20px; border-left: 4px solid var(--accent-gold); margin-top: 10px;">
                            <div style="display: flex; align-items: center; gap: 10px; margin-bottom: 15px; font-weight: bold; color: var(--accent-gold);">
                                <i data-lucide="sparkles" size="18"></i>
                                AI-Generated Analysis (Gemini Pro) - ${new Date().toLocaleString()}
                            </div>
                            ${analysis.split('\n\n').map(p => p.trim() ? `<p style="margin-bottom: 15px;">${p}</p>` : '').join('')}
                        </div>
                    `;
                    lucide.createIcons();
                    showToast("AI Analysis Complete", "success");
                }

            } catch (error) {
                console.error("AI Analysis error:", error);
                analysisDiv.innerHTML = `
                    <div style="color: var(--bearish); padding: 20px; text-align: center; background: #fff3f3; border: 1px solid var(--bearish);">
                        <i data-lucide="alert-circle" size="24"></i>
                        <p style="margin-top: 10px; font-weight: bold;">AI Analysis Error</p>
                        <p style="font-size: 12px; color: #666; margin-top: 10px; line-height: 1.6;">
                            ${error.message}
                        </p>
                    </div>
                `;
                lucide.createIcons();
            } finally {
                btn.disabled = false;
            }
        }

        // ========== WALLET SCANNER ==========
        async function scanWallet() {
            const addr = document.getElementById('wallet-addr').value.trim();
            const resDiv = document.getElementById('wallet-results');
            
            if(!addr) return showToast("Input Wallet Address", "error");

            resDiv.innerHTML = "Querying Blockchain Nodes...";
            
            try {
                const response = await fetch(`https://api.blockcypher.com/v1/btc/main/addrs/${addr}/balance`);
                
                if(!response.ok) throw new Error("Invalid Address or API Limit");
                
                const data = await response.json();
                const bal = (data.balance / 100000000).toFixed(4);
                const totalRx = (data.total_received / 100000000).toFixed(4);
                
                resDiv.innerHTML = `
                    <div style="background:#fff; border:1px solid #ddd; padding:10px;">
                        <strong>ADDRESS FOUND</strong><br>
                        <span style="color:var(--accent-gold)">Balance: ${bal} BTC</span><br>
                        <span>Total Vol: ${totalRx} BTC</span><br>
                        <span>Tx Count: ${data.n_tx}</span>
                    </div>
                `;
                showToast("On-Chain Analysis Complete", "success");

            } catch (err) {
                resDiv.innerHTML = `<span style="color:var(--bearish)">Query Failed: Invalid BTC Address or Node Busy.</span>`;
            }
        }

        // ========== MARKET DATA ==========
        async function fetchFearGreed() {
            try {
                const res = await fetch('https://api.alternative.me/fng/');
                const data = await res.json();
                const fng = data.data[0];
                
                const value = fng.value;
                const classification = fng.value_classification;
                
                document.getElementById('fear-greed-val').innerText = value;
                document.getElementById('fear-greed-label').innerText = classification;
                document.getElementById('fear-greed-val-page').innerText = value;
                document.getElementById('fear-greed-label-page').innerText = classification;
                
            } catch (e) {
                console.error("Fear & Greed fetch failed:", e);
            }
        }

        async function fetchGlobalSentiment() {
            try {
                const globalRes = await fetch('https://api.coingecko.com/api/v3/global');
                const globalData = await globalRes.json();
                
                const btcDominance = globalData.data.market_cap_percentage.btc.toFixed(2);
                const totalMarketCap = globalData.data.total_market_cap.usd;
                const totalVolume = globalData.data.total_volume.usd;
                const marketCapChange = globalData.data.market_cap_change_percentage_24h_usd.toFixed(2);
                const activeCryptos = globalData.data.active_cryptocurrencies;

                document.getElementById('btc-dominance').innerText = `${btcDominance}%`;
                document.getElementById('total-market-cap').innerText = `$${(totalMarketCap / 1e12).toFixed(2)}T`;
                document.getElementById('total-volume').innerText = `$${(totalVolume / 1e9).toFixed(2)}B`;
                document.getElementById('market-cap-change').innerText = `${marketCapChange}%`;
                document.getElementById('market-cap-change').style.color = marketCapChange >= 0 ? 'var(--bullish)' : 'var(--bearish)';
                document.getElementById('active-cryptos').innerText = activeCryptos.toLocaleString();

                const btcRes = await fetch('https://api.coingecko.com/api/v3/coins/bitcoin');
                const btcData = await btcRes.json();
                
                const btcChange = btcData.market_data.price_change_percentage_24h;
                const btcPrice = btcData.market_data.current_price.usd;
                
                const changeDisplay = document.getElementById('btc-change-display');
                changeDisplay.innerText = `${btcChange >= 0 ? '+' : ''}${btcChange.toFixed(2)}%`;
                changeDisplay.style.color = btcChange >= 0 ? 'var(--bullish)' : 'var(--bearish)';
                document.getElementById('btc-price-display').innerText = `$${btcPrice.toLocaleString()}`;

            } catch (e) {
                console.error("Global sentiment fetch failed:", e);
            }
        }

        async function fetchTicker() {
            try {
                const res = await fetch('https://api.coingecko.com/api/v3/simple/price?ids=bitcoin,ethereum,solana,cardano,ripple&vs_currencies=usd&include_24hr_change=true');
                const data = await res.json();
                const track = document.getElementById('ticker');
                track.innerHTML = Object.keys(data).map(k => `
                    <span class="ticker-item">${k.toUpperCase()}: $${data[k].usd.toLocaleString()} 
                    <span style="color: ${data[k].usd_24h_change >= 0 ? '#1a7d1a' : '#b21203'}">${data[k].usd_24h_change.toFixed(2)}%</span></span>
                `).join('') + " | ALL FEATURES FREE | 10% TO CHARITY";
            } catch (e) { 
                console.error("Ticker sync failed:", e);
            }
        }

        async function fetchNews() {
            try {
                const res = await fetch(`https://min-api.cryptocompare.com/data/v2/news/?lang=EN`);
                const json = await res.json();
                const articles = json.Data;
                
                if(!articles || articles.length === 0) return;

                document.getElementById('hero-section').innerHTML = `
                    <div style="margin-bottom:30px; cursor:pointer;" onclick="window.open('${articles[0].url}')">
                        <h1 style="font-family:'Playfair Display'; font-size:36px; line-height: 1.2;">${articles[0].title}</h1>
                        <p style="color:#666; margin-top:10px;">${articles[0].body.substring(0,200)}...</p>
                        <div style="font-size:10px; font-weight:bold; margin-top:10px; color:var(--accent-gold);">READ DESPATCH -></div>
                    </div>`;
                
                document.getElementById('news-grid').innerHTML = articles.slice(1, 15).map(a => `
                    <div style="border-bottom:1px solid #eee; padding-bottom:10px; cursor:pointer;" onclick="window.open('${a.url}')">
                        <span style="font-size:10px; color:var(--accent-gold); font-weight:800;">${a.source.toUpperCase()}</span>
                        <h3 style="font-family:'Playfair Display'; font-size:16px; margin-top:5px;">${a.title}</h3>
                    </div>
                `).join('');
            } catch(e) { 
                console.error("News stream failed:", e);
            }
        }
        
        async function fetchCoinDetails(coin) {
            try {
                const res = await fetch(`https://api.coingecko.com/api/v3/coins/${coin}`);
                const data = await res.json();
                
                document.getElementById('btc-price').innerText = `$${data.market_data.current_price.usd.toLocaleString()}`;
                document.getElementById('btc-vol').innerText = `$${(data.market_data.total_volume.usd / 1e9).toFixed(2)}B`;
                document.getElementById('btc-cap').innerText = `$${(data.market_data.market_cap.usd / 1e9).toFixed(2)}B`;
                document.getElementById('btc-supply').innerText = `${parseInt(data.market_data.circulating_supply).toLocaleString()} BTC`;
            } catch (e) {
                console.error("Coin details fetch failed:", e);
            }
        }

        async function fetchMarketOverview() {
            try {
                const res = await fetch('https://api.coingecko.com/api/v3/coins/markets?vs_currency=usd&order=market_cap_desc&per_page=5&page=1');
                const coins = await res.json();
                
                document.getElementById('market-overview').innerHTML = coins.map(coin => `
                    <div style="display: flex; justify-content: space-between; align-items: center; padding: 8px 0; border-bottom: 1px solid #ddd; font-size: 11px;">
                        <div>
                            <strong>${coin.symbol.toUpperCase()}</strong>
                            <div style="color: #666; font-size: 10px;">${coin.name}</div>
                        </div>
                        <div style="text-align: right;">
                            <div style="font-weight: bold;">$${coin.current_price.toLocaleString()}</div>
                            <div style="color: ${coin.price_change_percentage_24h >= 0 ? 'var(--bullish)' : 'var(--bearish)'}; font-size: 10px;">
                                ${coin.price_change_percentage_24h >= 0 ? '+' : ''}${coin.price_change_percentage_24h.toFixed(2)}%
                            </div>
                        </div>
                    </div>
                `).join('');
            } catch (e) {
                console.error("Market overview fetch failed:", e);
            }
        }

        // ========== AUTH STATE OBSERVER ==========
        if (firebaseInitialized && auth) {
            auth.onAuthStateChanged(async (user) => {
                if (user) {
                    currentUser = user;
                    updateUserDisplay();
                } else {
                    currentUser = null;
                }
            });
        }

        // ========== INITIALIZATION ==========
        async function init() {
            // Time & Date
            setInterval(() => {
                document.getElementById('live-clock').innerText = new Date().toLocaleString('en-US', { 
                    weekday: 'long', month: 'long', day: 'numeric', 
                    hour: '2-digit', minute: '2-digit', second: '2-digit' 
                }).toUpperCase();
            }, 1000);

            // Load data
            fetchNews();
            fetchTicker();
            fetchFearGreed();
            fetchMarketOverview();
            fetchGlobalSentiment();
            initChart('tv-container');

            // Show welcome message
            setTimeout(() => {
                showToast("All features are 100% FREE!", "success");
            }, 2000);
        }

        init();
        setInterval(fetchTicker, 60000);
        setInterval(fetchFearGreed, 300000);
        setInterval(fetchMarketOverview, 60000);
    </script>
</body>
</html>
